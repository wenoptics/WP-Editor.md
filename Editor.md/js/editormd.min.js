(function(a){if(typeof require==="function"&&typeof exports==="object"&&typeof module==="object"){module.exports=a}else{if(typeof define==="function"){if(define.amd){}else{define(["jquery"],a)}}else{window.editormd=a()}}}(function(){var f=(typeof(jQuery)!=="undefined")?jQuery:Zepto;if(typeof(f)==="undefined"){return}var d=function(j,i){return new d.fn.init(j,i)};d.title=d.$name="WP Editor.md";d.version="最新版";d.homePage="<a href='https://iiong.com/wordpress-plugins-wp-editormd.html' rel='nofollow' target='_blank'>淮城一只猫</a>开发的WordPress Markdown插件";d.classPrefix="editormd-";d.toolbarModes={full:["undo","redo","|","bold","del","italic","quote","ucwords","uppercase","lowercase","|","h1","h2","h3","h4","h5","h6","|","list-ul","list-ol","hr","|","link","reference-link","image","code","preformatted-text","code-block","table","datetime","emoji","html-entities","pagebreak","|","goto-line","watch","preview","fullscreen","clear","search","|","help","info"],simple:["undo","redo","|","bold","del","italic","quote","uppercase","lowercase","|","h1","h2","h3","h4","h5","h6","|","list-ul","list-ol","hr","|","watch","preview","fullscreen","|","help","info"],mini:["undo","redo","|","watch","preview","|","help","info"]};d.defaults={mode:"gfm",name:"",value:"",theme:"",editorTheme:"default",previewTheme:"",markdown:"",appendMarkdown:"",width:"100%",height:"100%",path:"./lib/",pluginPath:"",delay:300,autoLoadModules:true,watch:true,placeholder:"Enjoy Markdown! coding now...",gotoLine:true,codeFold:false,autoHeight:false,minHeight:"150px",maxHeight:"none",autoFocus:true,autoCloseTags:true,searchReplace:true,syncScrolling:true,readOnly:false,tabSize:4,indentUnit:4,lineNumbers:true,lineWrapping:true,autoCloseBrackets:true,showTrailingSpace:true,matchBrackets:true,indentWithTabs:true,styleSelectedText:true,matchWordHighlight:true,styleActiveLine:true,dialogLockScreen:true,dialogShowMask:true,dialogDraggable:true,dialogMaskBgColor:"#fff",dialogMaskOpacity:0.1,fontSize:"13px",saveHTMLToTextarea:false,disabledKeyMaps:[],onload:function(){},onresize:function(){},onchange:function(){},onwatch:null,onunwatch:null,onpreviewing:function(){},onpreviewed:function(){},onfullscreen:function(){},onfullscreenExit:function(){},onscroll:function(){},onpreviewscroll:function(){},imageUpload:false,imageFormats:["jpg","jpeg","gif","png","bmp","webp"],imageUploadURL:"",crossDomainUpload:false,uploadCallbackURL:"",toc:true,tocm:false,tocTitle:"",tocDropdown:false,tocContainer:"",tocStartLevel:1,htmlDecode:false,pageBreak:true,atLink:true,emailLink:true,taskList:false,emoji:false,tex:false,flowChart:false,sequenceDiagram:false,previewCodeHighlight:true,toolbar:true,toolbarAutoFixed:true,toolbarIcons:"full",toolbarTitles:{},toolbarHandlers:{ucwords:function(){return d.toolbarHandlers.ucwords},lowercase:function(){return d.toolbarHandlers.lowercase}},toolbarCustomIcons:{lowercase:'<a href="javascript:;" title="Lowercase" unselectable="on"><i class="fa" name="lowercase" style="font-size:24px;margin-top: -10px;">a</i></a>',ucwords:'<a href="javascript:;" title="ucwords" unselectable="on"><i class="fa" name="ucwords" style="font-size:20px;margin-top: -3px;">Aa</i></a>'},toolbarIconsClass:{undo:"fa-undo",redo:"fa-repeat",bold:"fa-bold",del:"fa-strikethrough",italic:"fa-italic",quote:"fa-quote-left",uppercase:"fa-font",h1:d.classPrefix+"bold",h2:d.classPrefix+"bold",h3:d.classPrefix+"bold",h4:d.classPrefix+"bold",h5:d.classPrefix+"bold",h6:d.classPrefix+"bold","list-ul":"fa-list-ul","list-ol":"fa-list-ol",hr:"fa-minus",link:"fa-link","reference-link":"fa-anchor",image:"fa-picture-o",code:"fa-code","preformatted-text":"fa-file-code-o","code-block":"fa-file-code-o",table:"fa-table",datetime:"fa-clock-o",emoji:"fa-smile-o","html-entities":"fa-copyright",pagebreak:"fa-newspaper-o","goto-line":"fa-terminal",watch:"fa-eye-slash",unwatch:"fa-eye",preview:"fa-desktop",search:"fa-search",fullscreen:"fa-arrows-alt",clear:"fa-eraser",help:"fa-question-circle",info:"fa-info-circle"},toolbarIconTexts:{},lang:{name:"zh-cn",description:"开源在线Markdown编辑器<br/>Open source online Markdown editor.",tocTitle:"目录",toolbar:{undo:"撤销（Ctrl+Z）",redo:"重做（Ctrl+Y）",bold:"粗体",del:"删除线",italic:"斜体",quote:"引用",ucwords:"将每个单词首字母转成大写",uppercase:"将所选转换成大写",lowercase:"将所选转换成小写",h1:"标题1",h2:"标题2",h3:"标题3",h4:"标题4",h5:"标题5",h6:"标题6","list-ul":"无序列表","list-ol":"有序列表",hr:"横线",link:"链接","reference-link":"引用链接",image:"添加图片",code:"行内代码","preformatted-text":"预格式文本 / 代码块（缩进风格）","code-block":"代码块（多语言风格）",table:"添加表格",datetime:"日期时间",emoji:"Emoji表情","html-entities":"HTML实体字符",pagebreak:"插入分页符","goto-line":"跳转到行",watch:"关闭实时预览",unwatch:"开启实时预览",preview:"全窗口预览HTML（按 Shift + ESC还原）",fullscreen:"全屏（按ESC还原）",clear:"清空",search:"搜索",help:"使用帮助",info:"关于"+d.title},buttons:{enter:"确定",cancel:"取消",close:"关闭"},dialog:{link:{title:"添加链接",url:"链接地址",urlTitle:"链接标题",urlEmpty:"错误：请填写链接地址。"},referenceLink:{title:"添加引用链接",name:"引用名称",url:"链接地址",urlId:"链接ID",urlTitle:"链接标题",nameEmpty:"错误：引用链接的名称不能为空。",idEmpty:"错误：请填写引用链接的ID。",urlEmpty:"错误：请填写引用链接的URL地址。"},image:{title:"添加图片",url:"图片地址",link:"图片链接",alt:"图片描述",uploadButton:"本地上传",imageURLEmpty:"错误：图片地址不能为空。",uploadFileEmpty:"错误：上传的图片不能为空。",formatNotAllowed:"错误：只允许上传图片文件，允许上传的图片文件格式有："},preformattedText:{title:"添加预格式文本或代码块",emptyAlert:"错误：请填写预格式文本或代码的内容。"},codeBlock:{title:"添加代码块",selectLabel:"代码语言：",selectDefaultText:"请选择代码语言",otherLanguage:"其他语言",unselectedLanguageAlert:"错误：请选择代码所属的语言类型。",codeEmptyAlert:"错误：请填写代码内容。"},htmlEntities:{title:"HTML 实体字符"},help:{title:"使用帮助"}}}};d.classNames={tex:d.classPrefix+"tex"};d.dialogZindex=99999;d.$katex=null;d.$marked=null;d.$CodeMirror=null;d.$prettyPrint=null;var h,e;d.prototype=d.fn={state:{watching:false,loaded:false,preview:false,fullscreen:false},init:function(k,q){q=q||{};if(typeof k==="object"){q=k}var n=this;var p=this.classPrefix=d.classPrefix;var l=this.settings=f.extend(true,d.defaults,q);k=(typeof k==="object")?l.id:k;var o=this.editor=f("#"+k);this.id=k;this.lang=l.lang;var i=this.classNames={textarea:{html:p+"html-textarea",markdown:p+"markdown-textarea"}};l.pluginPath=(l.pluginPath==="")?l.path+"../plugins/":l.pluginPath;this.state.watching=(l.watch)?true:false;if(!o.hasClass("editormd")){o.addClass("editormd")}o.css({width:(typeof l.width==="number")?l.width+"px":l.width,height:(typeof l.height==="number")?l.height+"px":l.height});if(l.autoHeight){o.css({height:"auto",minHeight:l.minHeight})}var j=this.markdownTextarea=o.children("textarea");if(j.length<1){o.append("<textarea></textarea>");j=this.markdownTextarea=o.children("textarea")}j.addClass(i.textarea.markdown).attr("placeholder",l.placeholder);if(typeof j.attr("name")==="undefined"||j.attr("name")===""){j.attr("name",(l.name!=="")?l.name:k+"-markdown-doc")}var m=[(!l.readOnly)?'<a href="javascript:;" class="'+p+'preview-close-btn"><i class="fa fa-close "></i> </a>':"",((l.saveHTMLToTextarea)?'<textarea class="'+i.textarea.html+'" name="'+k+'-html-code"></textarea>':""),'<div class="'+p+'preview"><div class="markdown-body '+p+'preview-container"></div></div>','<div class="'+p+'container-mask" style="display:block;"></div>','<div class="'+p+'mask"></div>'].join("\n");o.append(m).addClass(p+"vertical");if(l.theme!==""){o.addClass(p+"theme-"+l.theme)}this.mask=o.children("."+p+"mask");this.containerMask=o.children("."+p+"container-mask");if(l.markdown!==""){j.val(l.markdown)}if(l.appendMarkdown!==""){j.val(j.val()+l.appendMarkdown)}this.htmlTextarea=o.children("."+i.textarea.html);this.preview=o.children("."+p+"preview");this.previewContainer=this.preview.children("."+p+"preview-container");if(l.previewTheme!==""){this.preview.addClass(p+"preview-theme-"+l.previewTheme)}if(typeof define==="function"&&define.amd){if(typeof katex!=="undefined"){d.$katex=katex}if(l.searchReplace&&!l.readOnly){d.loadCSS(l.path+"codemirror/addon/dialog/dialog");d.loadCSS(l.path+"codemirror/addon/search/matchesonscrollbar")}}if((typeof define==="function"&&define.amd)||!l.autoLoadModules){if(typeof CodeMirror!=="undefined"){d.$CodeMirror=CodeMirror}if(typeof marked!=="undefined"){d.$marked=marked}this.setCodeMirror().setToolbar().loadedDisplay()}else{this.loadQueues()}return this},loadQueues:function(){var l=this;var k=this.settings;var i=k.path;var j=function(){if(d.isIE8){l.loadedDisplay();return}if(k.flowChart||k.sequenceDiagram){d.loadScript(i+"raphael.min",function(){d.loadScript(i+"underscore.min",function(){if(!k.flowChart&&k.sequenceDiagram){d.loadScript(i+"sequence-diagram.min",function(){l.loadedDisplay()})}else{if(k.flowChart&&!k.sequenceDiagram){d.loadScript(i+"flowchart.min",function(){d.loadScript(i+"jquery.flowchart.min",function(){l.loadedDisplay()})})}else{if(k.flowChart&&k.sequenceDiagram){d.loadScript(i+"flowchart.min",function(){d.loadScript(i+"jquery.flowchart.min",function(){d.loadScript(i+"sequence-diagram.min",function(){l.loadedDisplay()})})})}}}})})}else{l.loadedDisplay()}};d.loadCSS(i+"codemirror/codemirror.min");if(k.searchReplace&&!k.readOnly){d.loadCSS(i+"codemirror/addon/dialog/dialog");d.loadCSS(i+"codemirror/addon/search/matchesonscrollbar")}if(k.codeFold){d.loadCSS(i+"codemirror/addon/fold/foldgutter")}d.loadScript(i+"codemirror/codemirror.min",function(){d.$CodeMirror=CodeMirror;d.loadScript(i+"codemirror/modes.min",function(){d.loadScript(i+"codemirror/addons.min",function(){l.setCodeMirror();if(k.mode!=="gfm"&&k.mode!=="markdown"){l.loadedDisplay();return false}l.setToolbar();d.loadScript(i+"marked.min",function(){d.$marked=marked;if(k.previewCodeHighlight){d.loadScript(i+"prettify.min",function(){j()})}else{j()}})})})});return this},setTheme:function(l){var k=this.editor;var j=this.settings.theme;var i=this.classPrefix+"theme-";k.removeClass(i+j).addClass(i+l);this.settings.theme=l;return this},setEditorTheme:function(j){var i=this.settings;i.editorTheme=j;if(j!=="default"){d.loadCSS(i.path+"codemirror/theme/"+i.editorTheme)}this.cm.setOption("theme",j);return this},setCodeMirrorTheme:function(i){this.setEditorTheme(i);return this},setPreviewTheme:function(l){var k=this.preview;var j=this.settings.previewTheme;var i=this.classPrefix+"preview-theme-";k.removeClass(i+j).addClass(i+l);this.settings.previewTheme=l;return this},setCodeMirror:function(){var k=this.settings;var j=this.editor;if(k.editorTheme!=="default"){d.loadCSS(k.path+"codemirror/theme/"+k.editorTheme)}var i={mode:k.mode,theme:k.editorTheme,tabSize:k.tabSize,dragDrop:false,autofocus:k.autoFocus,autoCloseTags:k.autoCloseTags,readOnly:(k.readOnly)?"nocursor":false,indentUnit:k.indentUnit,lineNumbers:k.lineNumbers,lineWrapping:k.lineWrapping,extraKeys:{"Ctrl-Q":function(l){l.foldCode(l.getCursor())}},foldGutter:k.codeFold,gutters:["CodeMirror-linenumbers","CodeMirror-foldgutter"],matchBrackets:k.matchBrackets,indentWithTabs:k.indentWithTabs,styleActiveLine:k.styleActiveLine,styleSelectedText:k.styleSelectedText,autoCloseBrackets:k.autoCloseBrackets,showTrailingSpace:k.showTrailingSpace,highlightSelectionMatches:((!k.matchWordHighlight)?false:{showToken:(k.matchWordHighlight==="onselected")?false:/\w/})};this.codeEditor=this.cm=d.$CodeMirror.fromTextArea(this.markdownTextarea[0],i);this.codeMirror=this.cmElement=j.children(".CodeMirror");if(k.value!==""){this.cm.setValue(k.value)}this.codeMirror.css({fontSize:k.fontSize,width:(!k.watch)?"100%":"50%"});if(k.autoHeight){this.codeMirror.css({height:"auto",minHeight:k.minHeight,maxHeight:k.maxHeight});this.codeMirror.find(".CodeMirror-gutters").css({minHeight:k.minHeight});this.codeMirror.find(".CodeMirror-scroll").css({minHeight:k.minHeight,maxHeight:k.maxHeight});this.cm.setOption("viewportMargin",Infinity)}if(!k.lineNumbers){this.codeMirror.find(".CodeMirror-gutters").css("border-right","none")}return this},getCodeMirrorOption:function(i){return this.cm.getOption(i)},setCodeMirrorOption:function(i,j){this.cm.setOption(i,j);return this},addKeyMap:function(j,i){this.cm.addKeyMap(j,i);return this},removeKeyMap:function(i){this.cm.removeKeyMap(i);return this},gotoLine:function(u){var l=this.settings;if(!l.gotoLine){return this}var s=this.cm;var o=this.editor;var n=s.lineCount();var q=this.preview;if(typeof u==="string"){if(u==="last"){u=n}if(u==="first"){u=1}}if(typeof u!=="number"){alert("Error: The line number must be an integer.");return this}u=parseInt(u)-1;if(u>n){alert("Error: The line number range 1-"+n);return this}s.setCursor({line:u,ch:0});var j=s.getScrollInfo();var m=j.clientHeight;var r=s.charCoords({line:u,ch:0},"local");s.scrollTo(null,(r.top+r.bottom-m)/2);if(l.watch){var k=this.codeMirror.find(".CodeMirror-scroll")[0];var t=f(k).height();var i=k.scrollTop;var p=(i/k.scrollHeight);if(i===0){q.scrollTop(0)}else{if(i+t>=k.scrollHeight-16){q.scrollTop(q[0].scrollHeight)}else{q.scrollTop(q[0].scrollHeight*p)}}}s.focus();return this},extend:function(){if(typeof arguments[1]!=="undefined"){if(typeof arguments[1]==="function"){arguments[1]=f.proxy(arguments[1],this)}this[arguments[0]]=arguments[1]}if(typeof arguments[0]==="object"&&typeof arguments[0].length==="undefined"){f.extend(true,this,arguments[0])}return this},set:function(i,j){if(typeof j!=="undefined"&&typeof j==="function"){j=f.proxy(j,this)}this[i]=j;return this},config:function(i,k){var j=this.settings;if(typeof i==="object"){j=f.extend(true,j,i)}if(typeof i==="string"){j[i]=k}this.settings=j;this.recreate();return this},on:function(i,k){var j=this.settings;if(typeof j["on"+i]!=="undefined"){j["on"+i]=f.proxy(k,this)}return this},off:function(i){var j=this.settings;if(typeof j["on"+i]!=="undefined"){j["on"+i]=function(){}}return this},showToolbar:function(j){var i=this.settings;if(i.readOnly){return this}if(i.toolbar&&(this.toolbar.length<1||this.toolbar.find("."+this.classPrefix+"menu").html()==="")){this.setToolbar()}i.toolbar=true;this.toolbar.show();this.resize();f.proxy(j||function(){},this)();return this},hideToolbar:function(j){var i=this.settings;i.toolbar=false;this.toolbar.hide();this.resize();f.proxy(j||function(){},this)();return this},setToolbarAutoFixed:function(m){var n=this.state;var k=this.editor;var l=this.toolbar;var j=this.settings;if(typeof m!=="undefined"){j.toolbarAutoFixed=m}var i=function(){var p=f(window);var o=p.scrollTop();if(!j.toolbarAutoFixed){return false}if(o-k.offset().top>10&&o-k.offset().top<k.height()-l.height()){l.css({position:"fixed",width:k.width()+"px",left:k.offset().left+"px"})}else{l.css({position:"absolute",width:"100%",left:0})}};if(!n.fullscreen&&!n.preview&&j.toolbar&&j.toolbarAutoFixed){f(window).bind("scroll",i)}return this},setToolbar:function(){var y=this.settings;if(y.readOnly){return this}var o=this.editor;var u=this.preview;var m=this.classPrefix;var r=this.toolbar=o.children("."+m+"toolbar");if(y.toolbar&&r.length<1){var t='<div class="'+m+'toolbar"><div class="'+m+'toolbar-container"><ul class="'+m+'menu"></ul></div></div>';o.append(t);r=this.toolbar=o.children("."+m+"toolbar")}if(!y.toolbar){r.hide();return this}r.show();var z=(typeof y.toolbarIcons==="function")?y.toolbarIcons():((typeof y.toolbarIcons==="string")?d.toolbarModes[y.toolbarIcons]:y.toolbarIcons);var l=r.find("."+this.classPrefix+"menu"),k="";var v=false;for(var w=0,x=z.length;w<x;w++){var B=z[w];if(B==="||"){v=true}else{if(B==="|"){k+='<li class="divider" unselectable="on">|</li>'}else{var p=(/h(\d)/.test(B));var q=B;if(B==="watch"&&!y.watch){q="unwatch"}var A=y.lang.toolbar[q];var s=y.toolbarIconTexts[q];var j=y.toolbarIconsClass[q];A=(typeof A==="undefined")?"":A;s=(typeof s==="undefined")?"":s;j=(typeof j==="undefined")?"":j;var n=v?'<li class="pull-right">':"<li>";if(typeof y.toolbarCustomIcons[B]!=="undefined"&&typeof y.toolbarCustomIcons[B]!=="function"){n+=y.toolbarCustomIcons[B]}else{n+='<a href="javascript:;" title="'+A+'" unselectable="on">';n+='<i class="fa '+j+'" name="'+B+'" unselectable="on">'+((p)?B.toUpperCase():((j==="")?s:""))+"</i>";n+="</a>"}n+="</li>";k=v?n+k:k+n}}}l.html(k);l.find('[title="Lowercase"]').attr("title",y.lang.toolbar.lowercase);l.find('[title="ucwords"]').attr("title",y.lang.toolbar.ucwords);this.setToolbarHandler();this.setToolbarAutoFixed();return this},dialogLockScreen:function(){f.proxy(d.dialogLockScreen,this)();return this},dialogShowMask:function(i){f.proxy(d.dialogShowMask,this)(i);return this},getToolbarHandles:function(i){var j=this.toolbarHandlers=d.toolbarHandlers;return(i&&typeof toolbarIconHandlers[i]!=="undefined")?j[i]:j},setToolbarHandler:function(){var o=this;var l=this.settings;if(!l.toolbar||l.readOnly){return this}var m=this.toolbar;var j=this.cm;var i=this.classPrefix;var n=this.toolbarIcons=m.find("."+i+"menu > li > a");var k=this.getToolbarHandles();n.bind(d.mouseOrTouch("click","touchend"),function(s){var r=f(this).children(".fa");var p=r.attr("name");var t=j.getCursor();var q=j.getSelection();if(p===""){return}o.activeIcon=r;if(typeof k[p]!=="undefined"){f.proxy(k[p],o)(j)}else{if(typeof l.toolbarHandlers[p]!=="undefined"){f.proxy(l.toolbarHandlers[p],o)(j,r,t,q)}}if(p!=="link"&&p!=="reference-link"&&p!=="image"&&p!=="code-block"&&p!=="preformatted-text"&&p!=="watch"&&p!=="preview"&&p!=="search"&&p!=="fullscreen"&&p!=="info"){j.focus()}return false});return this},createDialog:function(i){return f.proxy(d.createDialog,this)(i)},createInfoDialog:function(){var m=this;var k=this.editor;var i=this.classPrefix;var l=['<div class="'+i+"dialog "+i+'dialog-info" style="">','<div class="'+i+'dialog-container">','<h1><i class="editormd-logo editormd-logo-lg editormd-logo-color"></i> '+d.title+"<small>v"+d.version+"</small></h1>","<p>"+this.lang.description+"</p>",'<p style="margin: 10px 0 20px 0;"><a href="'+d.homePage+'" target="_blank">'+d.homePage+' <i class="fa fa-external-link"></i></a></p>','<p style="font-size: 0.85em;">Copyright &copy; 2017 <a href="https://github.com/JaxsonWang/WP-Editor.md" target="_blank" class="hover-link">淮城一只猫</a>, The <a href="https://github.com/JaxsonWang/WP-Editor.md/blob/master/LICENSE" target="_blank" class="hover-link">MIT</a> License.</p>',"</div>",'<a href="javascript:;" class="fa fa-close '+i+'dialog-close"></a>',"</div>"].join("\n");k.append(l);var j=this.infoDialog=k.children("."+i+"dialog-info");j.find("."+i+"dialog-close").bind(d.mouseOrTouch("click","touchend"),function(){m.hideInfoDialog()});j.css("border",(d.isIE8)?"1px solid #ddd":"").css("z-index",d.dialogZindex).show();this.infoDialogPosition();return this},infoDialogPosition:function(){var i=this.infoDialog;var j=function(){i.css({top:(f(window).height()-i.height())/2+"px",left:(f(window).width()-i.width())/2+"px"})};j();f(window).resize(j);return this},showInfoDialog:function(){f("html,body").css("overflow-x","hidden");var l=this;var k=this.editor;var j=this.settings;var i=this.infoDialog=k.children("."+this.classPrefix+"dialog-info");if(i.length<1){this.createInfoDialog()}this.lockScreen(true);this.mask.css({opacity:j.dialogMaskOpacity,backgroundColor:j.dialogMaskBgColor}).show();i.css("z-index",d.dialogZindex).show();this.infoDialogPosition();return this},hideInfoDialog:function(){f("html,body").css("overflow-x","");this.infoDialog.hide();this.mask.hide();this.lockScreen(false);return this},lockScreen:function(i){d.lockScreen(i);this.resize();return this},recreate:function(){var k=this;var j=this.editor;var i=this.settings;this.codeMirror.remove();this.setCodeMirror();if(!i.readOnly){if(j.find(".editormd-dialog").length>0){j.find(".editormd-dialog").remove()}if(i.toolbar){this.getToolbarHandles();this.setToolbar()}}this.loadedDisplay(true);return this},previewCodeHighlight:function(){var j=this.settings;var i=this.previewContainer;if(j.previewCodeHighlight){i.find("pre").addClass("prettyprint linenums");if(typeof prettyPrint!=="undefined"){prettyPrint()}}return this},katexRender:function(){if(h===null){return this}this.previewContainer.find("."+d.classNames.tex).each(function(){var i=f(this);d.$katex.render(i.text().replace(/…/g,"..."),i[0]);i.find(".katex").css("font-size","1.6em")});return this},flowChartAndSequenceDiagramRender:function(){var q=this;var l=this.settings;var k=this.previewContainer;if(d.isIE8){return this}if(l.flowChart){if(e===null){return this}k.find(".flowchart")&&k.find(".flowchart").length>0&&k.find(".flowchart").flowChart()}if(l.sequenceDiagram){k.find(".sequence-diagram")&&k.find(".sequence-diagram").length>0&&k.find(".sequence-diagram").sequenceDiagram({theme:"simple"})}var p=q.preview;var n=q.codeMirror;var m=n.find(".CodeMirror-scroll");var s=m.height();var j=m.scrollTop();var o=(j/m[0].scrollHeight);var i=0;p.find(".markdown-toc-list").each(function(){i+=f(this).height()});var r=p.find(".editormd-toc-menu").height();r=(!r)?0:r;if(l.syncScrolling){if(j===0){p.scrollTop(0)}else{if(j+s>=m[0].scrollHeight-16){p.scrollTop(p[0].scrollHeight)}else{p.scrollTop((p[0].scrollHeight+i+r)*o)}}}return this},registerKeyMaps:function(t){var s=this;var u=this.cm;var n=this.settings;var q=d.toolbarHandlers;var v=n.disabledKeyMaps;t=t||null;if(t){for(var p in t){if(f.inArray(p,v)<0){var l={};l[p]=t[p];u.addKeyMap(t)}}}else{for(var o in d.keyMaps){var j=d.keyMaps[o];var r=(typeof j==="string")?f.proxy(q[j],s):f.proxy(j,s);if(f.inArray(o,["F9","F10","F11"])<0&&f.inArray(o,v)<0){var m={};m[o]=r;u.addKeyMap(m)}}f(window).keydown(function(k){var i={"120":"F9","121":"F10","122":"F11"};if(f.inArray(i[k.keyCode],v)<0){switch(k.keyCode){case 120:f.proxy(q.watch,s)();return false;break;case 121:f.proxy(q.preview,s)();return false;break;case 122:f.proxy(q.fullscreen,s)();return false;break;default:break}}})}return this},bindScrollEvent:function(){var o=this;var p=this.preview;var k=this.settings;var n=this.codeMirror;var j=d.mouseOrTouch;if(!k.syncScrolling){return this}var i=function(){n.find(".CodeMirror-scroll").bind(j("scroll","touchmove"),function(v){var s=f(this).height();var w=f(this).scrollTop();var u=(w/f(this)[0].scrollHeight);var t=0;p.find(".markdown-toc-list").each(function(){t+=f(this).height()});var r=p.find(".editormd-toc-menu").height();r=(!r)?0:r;if(w===0){p.scrollTop(0)}else{if(w+s>=f(this)[0].scrollHeight-16){p.scrollTop(p[0].scrollHeight)}else{p.scrollTop((p[0].scrollHeight+t+r)*u)}}f.proxy(k.onscroll,o)(v)})};var l=function(){n.find(".CodeMirror-scroll").unbind(j("scroll","touchmove"))};var m=function(){p.bind(j("scroll","touchmove"),function(u){var r=f(this).height();var v=f(this).scrollTop();var t=(v/f(this)[0].scrollHeight);var s=n.find(".CodeMirror-scroll");if(v===0){s.scrollTop(0)}else{if(v+r>=f(this)[0].scrollHeight){s.scrollTop(s[0].scrollHeight)}else{s.scrollTop(s[0].scrollHeight*t)}}f.proxy(k.onpreviewscroll,o)(u)})};var q=function(){p.unbind(j("scroll","touchmove"))};n.bind({mouseover:i,mouseout:l,touchstart:i,touchend:l});if(k.syncScrolling==="single"){return this}p.bind({mouseover:m,mouseout:q,touchstart:m,touchend:q});return this},bindChangeEvent:function(){var k=this;var i=this.cm;var j=this.settings;i.on("change",function(m,l){if(j.watch){k.previewContainer.css("padding",j.autoHeight?"20px 20px 50px 40px":"20px")}h=setTimeout(function(){clearTimeout(h);k.save();h=null},j.delay)});return this},loadedDisplay:function(i){i=i||false;var m=this;var k=this.editor;var l=this.preview;var j=this.settings;this.containerMask.hide();this.save();if(j.watch){l.show()}k.data("oldWidth",k.width()).data("oldHeight",k.height());this.resize();this.registerKeyMaps();f(window).resize(function(){m.resize()});this.bindScrollEvent().bindChangeEvent();if(!i){f.proxy(j.onload,this)()}this.state.loaded=true;return this},width:function(i){this.editor.css("width",(typeof i==="number")?i+"px":i);this.resize();return this},height:function(i){this.editor.css("height",(typeof i==="number")?i+"px":i);this.resize();return this},resize:function(j,q){j=j||null;q=q||null;var i=this.state;var n=this.editor;var o=this.preview;var p=this.toolbar;var k=this.settings;var l=this.codeMirror;if(j){n.css("width",(typeof j==="number")?j+"px":j)}if(k.autoHeight&&!i.fullscreen&&!i.preview){n.css({height:"auto",minHeight:k.minHeight});l.css({height:"auto",minHeight:k.minHeight,maxHeight:k.maxHeight})}else{if(q){n.css("height",(typeof q==="number")?q+"px":q)}if(i.fullscreen){n.height(f(window).height())}if(k.toolbar&&!k.readOnly){l.css("margin-top",p.height()+1).height(n.height()-p.height())}else{l.css("margin-top",0).height(n.height())}}if(k.watch){l.width(n.width()/2);o.width((!i.preview)?n.width()/2:n.width());this.previewContainer.css("padding",k.autoHeight?"20px 20px 50px 40px":"20px");if(k.toolbar&&!k.readOnly){o.css("top",p.height()+1)}else{o.css("top",0)}if(k.autoHeight&&!i.fullscreen&&!i.preview){o.height("")}else{var m=(k.toolbar&&!k.readOnly)?n.height()-p.height():n.height();o.height(m)}}else{l.width(n.width());o.hide()}if(i.loaded){f.proxy(k.onresize,this)()}return this},save:function(){if(h===null){return this}var p=this;var j=this.state;var m=this.settings;var s=this.cm;var r=s.getValue();var l=this.previewContainer;if(m.mode!=="gfm"&&m.mode!=="markdown"){this.markdownTextarea.val(r);return this}var i=d.$marked;var n=this.markdownToC=[];var t=this.markedRendererOptions={toc:m.toc,tocm:m.tocm,tocStartLevel:m.tocStartLevel,pageBreak:m.pageBreak,taskList:m.taskList,emoji:m.emoji,tex:m.tex,atLink:m.atLink,emailLink:m.emailLink,flowChart:m.flowChart,sequenceDiagram:m.sequenceDiagram,previewCodeHighlight:m.previewCodeHighlight};var q=this.markedOptions={renderer:d.markedRenderer(n,t),gfm:true,tables:true,breaks:true,pedantic:false,sanitize:(m.htmlDecode)?false:true,smartLists:true,smartypants:true};i.setOptions(q);var k=d.$marked(r,q);k=d.filterHTMLTags(k,m.htmlDecode);this.markdownTextarea.text(r);s.save();if(m.saveHTMLToTextarea){this.htmlTextarea.text(k)}if(m.watch||(!m.watch&&j.preview)){l.html(k);this.previewCodeHighlight();if(m.toc){var o=(m.tocContainer==="")?l:f(m.tocContainer);var u=o.find("."+this.classPrefix+"toc-menu");o.attr("previewContainer",(m.tocContainer==="")?"true":"false");if(m.tocContainer!==""&&u.length>0){u.remove()}d.markdownToCRenderer(n,o,m.tocDropdown,m.tocStartLevel);if(m.tocDropdown||o.find("."+this.classPrefix+"toc-menu").length>0){d.tocDropdownMenu(o,(m.tocTitle!=="")?m.tocTitle:this.lang.tocTitle)}if(m.tocContainer!==""){l.find(".markdown-toc").css("border","none")}}if(m.tex){if(!d.kaTeXLoaded&&m.autoLoadModules){d.loadKaTeX(function(){d.$katex=katex;d.kaTeXLoaded=true;p.katexRender()})}else{d.$katex=katex;this.katexRender()}}if(m.flowChart||m.sequenceDiagram){e=setTimeout(function(){clearTimeout(e);p.flowChartAndSequenceDiagramRender();e=null},10)}if(j.loaded){f.proxy(m.onchange,this)()}}return this},focus:function(){this.cm.focus();return this},setCursor:function(i){this.cm.setCursor(i);return this},getCursor:function(){return this.cm.getCursor()},setSelection:function(j,i){this.cm.setSelection(j,i);return this},getSelection:function(){return this.cm.getSelection()},setSelections:function(i){this.cm.setSelections(i);return this},getSelections:function(){return this.cm.getSelections()},replaceSelection:function(i){this.cm.replaceSelection(i);return this},insertValue:function(i){this.replaceSelection(i);return this},appendMarkdown:function(k){var j=this.settings;var i=this.cm;i.setValue(i.getValue()+k);return this},setMarkdown:function(i){this.cm.setValue(i||this.settings.markdown);return this},getMarkdown:function(){return this.cm.getValue()},getValue:function(){return this.cm.getValue()},setValue:function(i){this.cm.setValue(i);return this},clear:function(){this.cm.setValue("");return this},getHTML:function(){if(!this.settings.saveHTMLToTextarea){alert("Error: settings.saveHTMLToTextarea == false");return false}return this.htmlTextarea.val()},getTextareaSavedHTML:function(){return this.getHTML()},getPreviewedHTML:function(){if(!this.settings.watch){alert("Error: settings.watch == false");return false}return this.previewContainer.html()},watch:function(m){var k=this.settings;if(f.inArray(k.mode,["gfm","markdown"])<0){return this}this.state.watching=k.watch=true;this.preview.show();if(this.toolbar){var i=k.toolbarIconsClass.watch;var l=k.toolbarIconsClass.unwatch;var j=this.toolbar.find(".fa[name=watch]");j.parent().attr("title",k.lang.toolbar.watch);j.removeClass(l).addClass(i)}this.codeMirror.css("border-right","1px solid #ddd").width(this.editor.width()/2);h=0;this.save().resize();if(!k.onwatch){k.onwatch=m||function(){}}f.proxy(k.onwatch,this)();return this},unwatch:function(m){var k=this.settings;this.state.watching=k.watch=false;this.preview.hide();if(this.toolbar){var i=k.toolbarIconsClass.watch;var l=k.toolbarIconsClass.unwatch;var j=this.toolbar.find(".fa[name=watch]");j.parent().attr("title",k.lang.toolbar.unwatch);j.removeClass(i).addClass(l)}this.codeMirror.css("border-right","none").width(this.editor.width());this.resize();if(!k.onunwatch){k.onunwatch=m||function(){}}f.proxy(k.onunwatch,this)();return this},show:function(j){j=j||function(){};var i=this;this.editor.show(0,function(){f.proxy(j,i)()});return this},hide:function(j){j=j||function(){};var i=this;this.editor.hide(0,function(){f.proxy(j,i)()});return this},previewing:function(){var p=this;var k=this.editor;var o=this.preview;var m=this.toolbar;var j=this.settings;var l=this.codeMirror;var i=this.previewContainer;if(f.inArray(j.mode,["gfm","markdown"])<0){return this}if(j.toolbar&&m){m.toggle();m.find(".fa[name=preview]").toggleClass("active")}l.toggle();var n=function(q){if(q.shiftKey&&q.keyCode===27){p.previewed()}};if(l.css("display")==="none"){this.state.preview=true;if(this.state.fullscreen){o.css("background","#fff")}k.find("."+this.classPrefix+"preview-close-btn").show().bind(d.mouseOrTouch("click","touchend"),function(){p.previewed()});if(!j.watch){this.save()}else{i.css("padding","")}i.addClass(this.classPrefix+"preview-active");o.show().css({position:"",top:0,width:k.width(),height:(j.autoHeight&&!this.state.fullscreen)?"auto":k.height()});if(this.state.loaded){f.proxy(j.onpreviewing,this)()}f(window).bind("keyup",n)}else{f(window).unbind("keyup",n);this.previewed()}},previewed:function(){var l=this.editor;var n=this.preview;var m=this.toolbar;var k=this.settings;var j=this.previewContainer;var i=l.find("."+this.classPrefix+"preview-close-btn");this.state.preview=false;this.codeMirror.show();if(k.toolbar){m.show()}n[(k.watch)?"show":"hide"]();i.hide().unbind(d.mouseOrTouch("click","touchend"));j.removeClass(this.classPrefix+"preview-active");if(k.watch){j.css("padding","20px")}n.css({background:null,position:"absolute",width:l.width()/2,height:(k.autoHeight&&!this.state.fullscreen)?"auto":l.height()-m.height(),top:(k.toolbar)?m.height():0});if(this.state.loaded){f.proxy(k.onpreviewed,this)()}return this},fullscreen:function(){var p=this;var m=this.state;var k=this.editor;var o=this.preview;var l=this.toolbar;var j=this.settings;var i=this.classPrefix+"fullscreen";if(l){l.find(".fa[name=fullscreen]").parent().toggleClass("active")}var n=function(q){if(!q.shiftKey&&q.keyCode===27){if(m.fullscreen){p.fullscreenExit()}}};if(!k.hasClass(i)){m.fullscreen=true;f("html,body").css("overflow","hidden");k.css({width:f(window).width(),height:f(window).height()}).addClass(i);this.resize();f.proxy(j.onfullscreen,this)();f(window).bind("keyup",n)}else{f(window).unbind("keyup",n);this.fullscreenExit()}return this},fullscreenExit:function(){var k=this.editor;var j=this.settings;var l=this.toolbar;var i=this.classPrefix+"fullscreen";this.state.fullscreen=false;if(l){l.find(".fa[name=fullscreen]").parent().removeClass("active")}f("html,body").css("overflow","");k.css({width:k.data("oldWidth"),height:k.data("oldHeight")}).removeClass(i);this.resize();f.proxy(j.onfullscreenExit,this)();return this},executePlugin:function(j,l){var m=this;var i=this.cm;var k=this.settings;l=k.pluginPath+l;if(typeof define==="function"){if(typeof this[j]==="undefined"){alert("Error: "+j+" plugin is not found, you are not load this plugin.");return this}this[j](i);return this}if(f.inArray(l,d.loadFiles.plugin)<0){d.loadPlugin(l,function(){d.loadPlugins[j]=m[j];m[j](i)})}else{f.proxy(d.loadPlugins[j],this)(i)}return this},search:function(j){var i=this.settings;if(!i.searchReplace){alert("Error: settings.searchReplace == false");return this}if(!i.readOnly){this.cm.execCommand(j||"find")}return this},searchReplace:function(){this.search("replace");return this},searchReplaceAll:function(){this.search("replaceAll");return this}};d.fn.init.prototype=d.fn;d.dialogLockScreen=function(){var i=this.settings||{dialogLockScreen:true};if(i.dialogLockScreen){f("html,body").css("overflow","hidden");this.resize()}};d.dialogShowMask=function(i){var k=this.editor;var j=this.settings||{dialogShowMask:true};i.css({top:(f(window).height()-i.height())/2+"px",left:(f(window).width()-i.width())/2+"px"});if(j.dialogShowMask){k.children("."+this.classPrefix+"mask").css("z-index",parseInt(i.css("z-index"))-1).show()}};d.toolbarHandlers={undo:function(){this.cm.undo()},redo:function(){this.cm.redo()},bold:function(){var i=this.cm;var k=i.getCursor();var j=i.getSelection();i.replaceSelection("**"+j+"**");if(j===""){i.setCursor(k.line,k.ch+2)}},del:function(){var i=this.cm;var k=i.getCursor();var j=i.getSelection();i.replaceSelection("~~"+j+"~~");if(j===""){i.setCursor(k.line,k.ch+2)}},italic:function(){var i=this.cm;var k=i.getCursor();var j=i.getSelection();i.replaceSelection("*"+j+"*");if(j===""){i.setCursor(k.line,k.ch+1)}},quote:function(){var i=this.cm;var k=i.getCursor();var j=i.getSelection();if(k.ch!==0){i.setCursor(k.line,0);i.replaceSelection("> "+j);i.setCursor(k.line,k.ch+2)}else{i.replaceSelection("> "+j)}},ucfirst:function(){var i=this.cm;var k=i.getSelection();var j=i.listSelections();i.replaceSelection(d.firstUpperCase(k));i.setSelections(j)},ucwords:function(){var i=this.cm;var k=i.getSelection();var j=i.listSelections();i.replaceSelection(d.wordsFirstUpperCase(k));i.setSelections(j)},uppercase:function(){var i=this.cm;var k=i.getSelection();var j=i.listSelections();i.replaceSelection(k.toUpperCase());i.setSelections(j)},lowercase:function(){var i=this.cm;var l=i.getCursor();var k=i.getSelection();var j=i.listSelections();i.replaceSelection(k.toLowerCase());i.setSelections(j)},h1:function(){var i=this.cm;var k=i.getCursor();var j=i.getSelection();if(k.ch!==0){i.setCursor(k.line,0);i.replaceSelection("# "+j);i.setCursor(k.line,k.ch+2)}else{i.replaceSelection("# "+j)}},h2:function(){var i=this.cm;var k=i.getCursor();var j=i.getSelection();if(k.ch!==0){i.setCursor(k.line,0);i.replaceSelection("## "+j);i.setCursor(k.line,k.ch+3)}else{i.replaceSelection("## "+j)}},h3:function(){var i=this.cm;var k=i.getCursor();var j=i.getSelection();if(k.ch!==0){i.setCursor(k.line,0);i.replaceSelection("### "+j);i.setCursor(k.line,k.ch+4)}else{i.replaceSelection("### "+j)}},h4:function(){var i=this.cm;var k=i.getCursor();var j=i.getSelection();if(k.ch!==0){i.setCursor(k.line,0);i.replaceSelection("#### "+j);i.setCursor(k.line,k.ch+5)}else{i.replaceSelection("#### "+j)}},h5:function(){var i=this.cm;var k=i.getCursor();var j=i.getSelection();if(k.ch!==0){i.setCursor(k.line,0);i.replaceSelection("##### "+j);i.setCursor(k.line,k.ch+6)}else{i.replaceSelection("##### "+j)}},h6:function(){var i=this.cm;var k=i.getCursor();var j=i.getSelection();if(k.ch!==0){i.setCursor(k.line,0);i.replaceSelection("###### "+j);i.setCursor(k.line,k.ch+7)}else{i.replaceSelection("###### "+j)}},"list-ul":function(){var k=this.cm;var o=k.getCursor();var m=k.getSelection();if(m===""){k.replaceSelection("- "+m)}else{var n=m.split("\n");for(var l=0,j=n.length;l<j;l++){n[l]=(n[l]==="")?"":"- "+n[l]}k.replaceSelection(n.join("\n"))}},"list-ol":function(){var k=this.cm;var o=k.getCursor();var m=k.getSelection();if(m===""){k.replaceSelection("1. "+m)}else{var n=m.split("\n");for(var l=0,j=n.length;l<j;l++){n[l]=(n[l]==="")?"":(l+1)+". "+n[l]}k.replaceSelection(n.join("\n"))}},hr:function(){var i=this.cm;var k=i.getCursor();var j=i.getSelection();i.replaceSelection(((k.ch!==0)?"\n\n":"\n")+"------------\n\n")},tex:function(){if(!this.settings.tex){alert("settings.tex === false");return this}var i=this.cm;var k=i.getCursor();var j=i.getSelection();i.replaceSelection("$$"+j+"$$");if(j===""){i.setCursor(k.line,k.ch+2)}},link:function(){this.executePlugin("linkDialog","link-dialog/link-dialog")},"reference-link":function(){this.executePlugin("referenceLinkDialog","reference-link-dialog/reference-link-dialog")},pagebreak:function(){if(!this.settings.pageBreak){alert("settings.pageBreak === false");return this}var i=this.cm;var j=i.getSelection();i.replaceSelection("\r\n<!--nextpage-->\r\n")},image:function(){this.executePlugin("imageDialog","image-dialog/image-dialog")},code:function(){var i=this.cm;var k=i.getCursor();var j=i.getSelection();i.replaceSelection("`"+j+"`");if(j===""){i.setCursor(k.line,k.ch+1)}},"code-block":function(){this.executePlugin("codeBlockDialog","code-block-dialog/code-block-dialog")},"preformatted-text":function(){this.executePlugin("preformattedTextDialog","preformatted-text-dialog/preformatted-text-dialog")},table:function(){this.executePlugin("tableDialog","table-dialog/table-dialog")},datetime:function(){var i=this.cm;var k=i.getSelection();var j=new Date();var l=this.settings.lang.name;var m=d.dateFormat()+" "+d.dateFormat((l==="zh-cn"||l==="zh-tw")?"cn-week-day":"week-day");i.replaceSelection(m)},emoji:function(){this.executePlugin("emojiDialog","emoji-dialog/emoji-dialog")},"html-entities":function(){this.executePlugin("htmlEntitiesDialog","html-entities-dialog/html-entities-dialog")},"goto-line":function(){this.executePlugin("gotoLineDialog","goto-line-dialog/goto-line-dialog")},watch:function(){this[this.settings.watch?"unwatch":"watch"]()},preview:function(){this.previewing()},fullscreen:function(){this.fullscreen()},clear:function(){this.clear()},search:function(){this.search()},help:function(){this.executePlugin("helpDialog","help-dialog/help-dialog")},info:function(){this.showInfoDialog()}};d.keyMaps={"Ctrl-1":"h1","Ctrl-2":"h2","Ctrl-3":"h3","Ctrl-4":"h4","Ctrl-5":"h5","Ctrl-6":"h6","Ctrl-B":"bold","Ctrl-D":"datetime","Ctrl-E":function(){var i=this.cm;var k=i.getCursor();var j=i.getSelection();if(!this.settings.emoji){alert("Error: settings.emoji == false");return}i.replaceSelection(":"+j+":");if(j===""){i.setCursor(k.line,k.ch+1)}},"Ctrl-Alt-G":"goto-line","Ctrl-H":"hr","Ctrl-I":"italic","Ctrl-K":"code","Ctrl-L":function(){var i=this.cm;var l=i.getCursor();var j=i.getSelection();var k=(j==="")?"":' "'+j+'"';i.replaceSelection("["+j+"]("+k+")");if(j===""){i.setCursor(l.line,l.ch+1)}},"Ctrl-U":"list-ul","Shift-Ctrl-A":function(){var i=this.cm;var k=i.getCursor();var j=i.getSelection();if(!this.settings.atLink){alert("Error: settings.atLink == false");return}i.replaceSelection("@"+j);if(j===""){i.setCursor(k.line,k.ch+1)}},"Shift-Ctrl-C":"code","Shift-Ctrl-Q":"quote","Shift-Ctrl-S":"del","Shift-Ctrl-K":"tex","Shift-Alt-C":function(){var i=this.cm;var k=i.getCursor();var j=i.getSelection();i.replaceSelection(["```",j,"```"].join("\n"));if(j===""){i.setCursor(k.line,k.ch+3)}},"Shift-Ctrl-Alt-C":"code-block","Shift-Ctrl-H":"html-entities","Shift-Alt-H":"help","Shift-Ctrl-E":"emoji","Shift-Ctrl-U":"uppercase","Shift-Alt-U":"ucwords","Shift-Ctrl-Alt-U":"ucfirst","Shift-Alt-L":"lowercase","Shift-Ctrl-I":function(){var i=this.cm;var l=i.getCursor();var j=i.getSelection();var k=(j==="")?"":' "'+j+'"';i.replaceSelection("!["+j+"]("+k+")");if(j===""){i.setCursor(l.line,l.ch+4)}},"Shift-Ctrl-Alt-I":"image","Shift-Ctrl-L":"link","Shift-Ctrl-O":"list-ol","Shift-Ctrl-P":"preformatted-text","Shift-Ctrl-T":"table","Shift-Alt-P":"pagebreak",F9:"watch",F10:"preview",F11:"fullscreen"};var c=function(i){return(!String.prototype.trim)?i.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,""):i.trim()};d.trim=c;var b=function(i){return i.toLowerCase().replace(/\b(\w)|\s(\w)/g,function(j){return j.toUpperCase()})};d.ucwords=d.wordsFirstUpperCase=b;var g=function(i){return i.toLowerCase().replace(/\b(\w)/,function(j){return j.toUpperCase()})};var a=g;d.firstUpperCase=d.ucfirst=g;d.urls={atLinkBase:"https://github.com/"};d.regexs={atLink:/@(\w+)/g,email:/(\w+)@(\w+)\.(\w+)\.?(\w+)?/g,emailLink:/(mailto:)?([\w\.\_]+)@(\w+)\.(\w+)\.?(\w+)?/g,emoji:/:([\w\+-]+):/g,emojiDatetime:/(\d{2}:\d{2}:\d{2})/g,twemoji:/:(tw-([\w]+)-?(\w+)?):/g,fontAwesome:/:(fa-([\w]+)(-(\w+)){0,}):/g,editormdLogo:/:(editormd-logo-?(\w+)?):/g,pageBreak:/^\[[=]{8,}\]$/};d.emoji={path:"http://www.emoji-cheat-sheet.com/graphics/emojis/",ext:".png"};d.twemoji={path:"http://twemoji.maxcdn.com/36x36/",ext:".png"};d.markedRenderer=function(o,w){var m={toc:true,tocm:false,tocStartLevel:1,pageBreak:true,atLink:true,emailLink:true,taskList:false,emoji:false,tex:false,flowChart:false,sequenceDiagram:false};var l=f.extend(m,w||{});var k=d.$marked;var r=new k.Renderer();o=o||[];var p=d.regexs;var n=p.atLink;var s=p.emoji;var u=p.email;var j=p.emailLink;var v=p.twemoji;var q=p.fontAwesome;var i=p.editormdLogo;var t=p.pageBreak;r.emoji=function(z){z=z.replace(d.regexs.emojiDatetime,function(B){return B.replace(/:/g,"&#58;")});var A=z.match(s);if(!A||!l.emoji){return z}for(var y=0,x=A.length;y<x;y++){if(A[y]===":+1:"){A[y]=":\\+1:"}z=z.replace(new RegExp(A[y]),function(L,H){var O=L.match(q);var D=L.replace(/:/g,"");if(O){for(var J=0,M=O.length;J<M;J++){var I=O[J].replace(/:/g,"");return'<i class="fa '+I+' fa-emoji" title="'+I.replace("fa-","")+'"></i>'}}else{var F=L.match(i);var E=L.match(v);if(F){for(var P=0,K=F.length;P<K;P++){var C=F[P].replace(/:/g,"");return'<i class="'+C+'" title="Editor.md logo ('+C+')"></i>'}}else{if(E){for(var Q=0,G=E.length;Q<G;Q++){var N=E[Q].replace(/:/g,"").replace("tw-","");return'<img src="'+d.twemoji.path+N+d.twemoji.ext+'" title="twemoji-'+N+'" alt="twemoji-'+N+'" class="emoji twemoji" />'}}else{var B=(D==="+1")?"plus1":D;B=(B==="black_large_square")?"black_square":B;B=(B==="moon")?"waxing_gibbous_moon":B;return'<img src="'+d.emoji.path+B+d.emoji.ext+'" class="emoji" title="&#58;'+D+'&#58;" alt="&#58;'+D+'&#58;" />'}}}})}return z};r.atLink=function(x){if(n.test(x)){if(l.atLink){x=x.replace(u,function(y,B,A,z){return y.replace(/@/g,"_#_&#64;_#_")});x=x.replace(n,function(y,z){return'<a href="'+d.urls.atLinkBase+""+z+'" title="&#64;'+z+'" class="at-link">'+y+"</a>"}).replace(/_#_&#64;_#_/g,"@")}if(l.emailLink){x=x.replace(j,function(y,C,B,A,z){return(!C&&f.inArray(z,"jpg|jpeg|png|gif|webp|ico|icon|pdf".split("|"))<0)?'<a href="mailto:'+y+'">'+y+"</a>":y})}return x}return x};r.link=function(x,C,B){if(this.options.sanitize){try{var z=decodeURIComponent(decodeURI(x)).replace(/[^\w:]/g,"").toLowerCase()}catch(A){return""}if(z.indexOf("javascript:")===0){return""}}var y='<a href="'+x+'"';if(n.test(C)||n.test(B)){if(C){y+=' title="'+C.replace(/@/g,"&#64;")}return y+'">'+B.replace(/@/g,"&#64;")+"</a>"}if(C){y+=' title="'+C+'"'}y+=">"+B+"</a>";return y};r.heading=function(J,x,I){var z=J;var B=/\s*\<a\s*href\=\"(.*)\"\s*([^\>]*)\>(.*)\<\/a\>\s*/;var D=/\s*\<a\s*([^\>]+)\>([^\>]*)\<\/a\>\s*/g;if(B.test(J)){var K=[];J=J.split(/\<a\s*([^\>]+)\>([^\>]*)\<\/a\>/);for(var C=0,F=J.length;C<F;C++){K.push(J[C].replace(/\s*href\=\"(.*)\"\s*/g,""))}J=K.join(" ")}J=c(J);var G=J.toLowerCase().replace(/[^\w]+/g,"-");var A={text:J,level:x,slug:G};var H=/^[\u4e00-\u9fa5]+$/.test(J);var y=J;o.push(A);var E="<h"+x+' id="'+this.options.headerPrefix+y.replace(/\s+{[ -~]*}/g,"")+'">';E+='<a name="'+J.replace(/<[^>]*>\s?/g,"").replace(/\s+{[ -~]*}/g,"")+'" class="reference-link"></a>';E+='<span class="header-link octicon octicon-link"></span>';E+=(B)?this.atLink(this.emoji(z.replace(/\s+{[ -~]*}/g,""))):this.atLink(this.emoji(J.replace(/\s+{[ -~]*}/g,"")));E+="</h"+x+">";return E};r.pageBreak=function(x){if(t.test(x)&&l.pageBreak){x='<hr style="page-break-after:always;" class="page-break editormd-page-break" />'}return x};r.paragraph=function(G){var D=/\$\$(.*)\$\$/g.test(G);var z=/^\$\$(.*)\$\$$/.test(G);var B=(z)?' class="'+d.classNames.tex+'"':"";var E=(l.tocm)?/^(\[toc\]|\[tocm\])$/.test(G):/^\[toc\]$/.test(G);var A=/^\[tocm\]$/.test(G);var y=/^\$seq([^\$]*)\$/gm.test(G);var C=/[\s\S]audio\s[\s\S]*?[\s\S][\s\S][/]audio<[/]a>[\s\S]/gm.test(G);var x=/[\s\S]video\s[\s\S]*?[\s\S][\s\S][/]video<[/]a>[\s\S]/gm.test(G);if(!z&&D){G=G.replace(/(\$\$([^\$]*)\$\$)+/g,function(H,I){return'<span class="'+d.classNames.tex+'">'+I.replace(/\$/g,"")+"</span>"})}else{G=(z)?G.replace(/\$/g,""):G}if(y){G=G.replace(/(\$seq([^\$]*)\$)+/gm,function(H,K,J,I){return'<div class="sequence-diagram">'+J.replace(/\$seq|\$/g,"").replace(/<br[\s\S]*?\>/g,"\n")+"</div>"})}if(C){G=G.replace(/([\s\S]audio\s[\s\S]*?[\s\S][\s\S][/]audio<[/]a>[\s\S])+/g,function(H,K,J,I){return'<audio src="'+K.replace(/[\s\S]audio\s[\s\S]*?[\s\S][\s\S][/]audio">/g,"").replace(/&quot;[\s\S][\s\S][/]audio<[/]a>[\s\S]/g,"")+'" controls="controls">Your browser does not support the audio element.</audio>'})}if(x){G=G.replace(/([\s\S]video\s[\s\S]*?[\s\S][\s\S][/]video<[/]a>[\s\S])+/g,function(H,K,J,I){return'<video src="'+K.replace(/[\s\S]video\s[\s\S]*?[\s\S][\s\S][/]video">/g,"").replace(/&quot;[\s\S][\s\S][/]video<[/]a>[\s\S]/g,"")+'" controls="controls">Your browser does not support the video element.</video>'})}var F='<div class="markdown-toc editormd-markdown-toc">'+G+"</div>";return(E)?((A)?'<div class="editormd-toc-menu">'+F+"</div><br/>":F):((t.test(G))?this.pageBreak(G):"<p"+B+">"+this.atLink(this.emoji(G))+"</p>\n")};r.code=function(x,z,y){if(z==="seq"||z==="sequence"){return'<div class="sequence-diagram">'+x+"</div>"}else{if(z==="flow"){return'<div class="flowchart">'+x+"</div>"}else{if(z==="math"||z==="latex"||z==="katex"){return'<p class="'+d.classNames.tex+'">'+x+"</p>"}else{return k.Renderer.prototype.code.apply(this,arguments)}}}return k.Renderer.prototype.code.apply(this,arguments)};r.tablecell=function(A,y){var z=(y.header)?"th":"td";var x=(y.align)?"<"+z+' style="text-align:'+y.align+'">':"<"+z+">";return x+this.atLink(this.emoji(A))+"</"+z+">\n"};r.listitem=function(x){if(l.taskList&&/^\s*\[[x\s]\]\s*/.test(x)){x=x.replace(/^\s*\[\s\]\s*/,'<input type="checkbox" class="task-list-item-checkbox" disabled /> ').replace(/^\s*\[x\]\s*/,'<input type="checkbox" class="task-list-item-checkbox" checked disabled /> ');return"<li>"+this.atLink(this.emoji(x))+"</li>"}else{return"<li>"+this.atLink(this.emoji(x))+"</li>"}};return r};d.markdownToCRenderer=function(m,l,v,n){var p="";var j=0;var t=this.classPrefix;n=n||1;for(var o=0,r=m.length;o<r;o++){var u=m[o].text;var k=m[o].level;if(k<n){continue}if(k>j){p+=""}else{if(k<j){p+=(new Array(j-k+2)).join("</ul></li>")}else{p+="</ul></li>"}}p+='<li><a class="toc-level-'+k+'" href="#'+u+'" level="'+k+'">'+u+"</a><ul>";j=k}var q=l.find(".markdown-toc");if((q.length<1&&l.attr("previewContainer")==="false")){var s='<div class="markdown-toc '+t+'markdown-toc"></div>';s=(v)?'<div class="'+t+'toc-menu">'+s+"</div>":s;l.html(s);q=l.find(".markdown-toc")}if(v){q.wrap('<div class="'+t+'toc-menu"></div><br/>')}q.html('<ul class="markdown-toc-list"></ul>').children(".markdown-toc-list").html(p.replace(/\r?\n?\<ul\>\<\/ul\>/g,""));return q};d.tocDropdownMenu=function(j,i){i=i||"Table of Contents";var k=400;var l=j.find("."+this.classPrefix+"toc-menu");l.each(function(){var p=f(this);var r=p.children(".markdown-toc");var n='<i class="fa fa-angle-down"></i>';var m='<a href="javascript:;" class="toc-menu-btn">'+n+i+"</a>";var q=r.children("ul");var o=q.find("li");r.append(m);o.first().before("<li><h1>"+i+" "+n+"</h1></li>");p.mouseover(function(){q.show();o.each(function(){var s=f(this);var u=s.children("ul");if(u.html()===""){u.remove()}if(u.length>0&&u.html()!==""){var t=s.children("a").first();if(t.children(".fa").length<1){t.append(f(n).css({"float":"right",paddingTop:"4px"}))}}s.mouseover(function(){u.css("z-index",k).show();k+=1}).mouseleave(function(){u.hide()})})}).mouseleave(function(){q.hide()})});return l};d.filterHTMLTags=function(m,j){if(typeof m!=="string"){m=String(m)}if(typeof j!=="string"){return m}console.log(m);var o=j.split("|");var k=o[0].split(",");var q=o[1];for(var l=0,n=k.length;l<n;l++){var r=k[l];m=m.replace(new RegExp("<s*"+r+"s*([^>]*)>([^>]*)<s*/"+r+"s*>","igm"),"")}if(typeof q!=="undefined"){var p=/\<(\w+)\s*([^\>]*)\>([^\>]*)\<\/(\1)\>/ig;if(q==="*"){m=m.replace(p,function(i,v,u,t,s){return"<"+v+">"+t+"</"+s+">"})}else{if(q==="on*"){m=m.replace(p,function(x,w,v,u,s){var t=f("<"+w+">"+u+"</"+s+">");var i=f(x)[0].attributes;var y={};f.each(i,function(A,B){if(B.nodeName!=='"'){y[B.nodeName]=B.nodeValue}});f.each(y,function(A){if(A.indexOf("on")===0){delete y[A]}});t.attr(y);var z=(typeof t[1]!=="undefined")?f(t[1]).text():"";if(w&&!isNaN(w)&&w!==s){z+="<"+w+">"+u+"</"+s+">"}else{if(w&&isNaN(w)&&w!==s){z+="</"+s+">";return t[0].outerHTML+z}else{return t[0].outerHTML+z}}})}else{m=m.replace(p,function(i,w,v,u){var t=q.split(",");var s=f(i);s.html(u);f.each(t,function(x){s.attr(t[x],null)});return s[0].outerHTML})}}}return m};d.markdownToHTML=function(j,u){var l={gfm:true,toc:true,tocm:false,tocStartLevel:1,tocTitle:"目录",tocDropdown:false,tocContainer:"",markdown:"",markdownSourceCode:false,htmlDecode:false,autoLoadKaTeX:true,pageBreak:true,atLink:true,emailLink:true,tex:false,taskList:false,emoji:false,flowChart:false,sequenceDiagram:false,previewCodeHighlight:true};d.$marked=marked;var i=f("#"+j);var k=i.settings=f.extend(true,l,u||{});var t=i.find("textarea");if(t.length<1){i.append("<textarea></textarea>");t=i.find("textarea")}var n=(k.markdown==="")?t.val():k.markdown;var m=[];var s={toc:k.toc,tocm:k.tocm,tocStartLevel:k.tocStartLevel,taskList:k.taskList,emoji:k.emoji,tex:k.tex,pageBreak:k.pageBreak,atLink:k.atLink,emailLink:k.emailLink,flowChart:k.flowChart,sequenceDiagram:k.sequenceDiagram,previewCodeHighlight:k.previewCodeHighlight};var r={renderer:d.markedRenderer(m,s),gfm:k.gfm,tables:true,breaks:true,pedantic:false,sanitize:(k.htmlDecode)?false:true,smartLists:true,smartypants:true};n=new String(n);var p=marked(n,r);p=d.filterHTMLTags(p,k.htmlDecode);if(k.markdownSourceCode){t.text(n)}else{t.remove()}i.addClass("markdown-body "+this.classPrefix+"html-preview").append(p);var o=(k.tocContainer!=="")?f(k.tocContainer):i;if(k.tocContainer!==""){o.attr("previewContainer",false)}if(k.toc){i.tocContainer=this.markdownToCRenderer(m,o,k.tocDropdown,k.tocStartLevel);if(k.tocDropdown||i.find("."+this.classPrefix+"toc-menu").length>0){this.tocDropdownMenu(i,k.tocTitle)}if(k.tocContainer!==""){i.find(".editormd-toc-menu, .editormd-markdown-toc").remove()}}if(k.previewCodeHighlight){i.find("pre").addClass("prettyprint linenums");prettyPrint()}if(!d.isIE8){if(k.flowChart){i.find(".flowchart").flowChart()}if(k.sequenceDiagram){i.find(".sequence-diagram").sequenceDiagram({theme:"simple"})}}if(k.tex){var q=function(){i.find("."+d.classNames.tex).each(function(){var v=f(this);katex.render(v.html().replace(/&lt;/g,"<").replace(/&gt;/g,">"),v[0]);v.find(".katex").css("font-size","1.6em")})};if(k.autoLoadKaTeX&&!d.$katex&&!d.kaTeXLoaded){this.loadKaTeX(function(){d.$katex=katex;d.kaTeXLoaded=true;q()})}else{q()}}i.getMarkdown=function(){return t.val()};return i};d.themes=["default","dark"];d.previewThemes=["default","dark"];d.editorThemes=["default","3024-day","3024-night","ambiance","ambiance-mobile","base16-dark","base16-light","blackboard","cobalt","eclipse","elegant","erlang-dark","lesser-dark","mbo","mdn-like","midnight","monokai","neat","neo","night","paraiso-dark","paraiso-light","pastel-on-dark","rubyblue","solarized","the-matrix","tomorrow-night-eighties","twilight","vibrant-ink","xq-dark","xq-light"];d.loadPlugins={};d.loadFiles={js:[],css:[],plugin:[]};d.loadPlugin=function(k,j,i){j=j||function(){};this.loadScript(k,function(){d.loadFiles.plugin.push(k);j()},i)};d.loadCSS=function(l,k,i){i=i||"head";k=k||function(){};var j=document.createElement("link");j.type="text/css";j.rel="stylesheet";j.onload=j.onreadystatechange=function(){d.loadFiles.css.push(l);k()};j.href=l+".css";if(i==="head"){document.getElementsByTagName("head")[0].appendChild(j)}else{document.body.appendChild(j)}};d.isIE=(navigator.appName=="Microsoft Internet Explorer");d.isIE8=(d.isIE&&navigator.appVersion.match(/8./i)=="8.");d.loadScript=function(l,k,j){j=j||"head";k=k||function(){};var i=null;i=document.createElement("script");i.id=l.replace(/[\./]+/g,"-");i.type="text/javascript";i.src=l+".js";if(d.isIE8){i.onreadystatechange=function(){if(i.readyState){if(i.readyState==="loaded"||i.readyState==="complete"){i.onreadystatechange=null;d.loadFiles.js.push(l);k()}}}}else{i.onload=function(){d.loadFiles.js.push(l);k()}}if(j==="head"){document.getElementsByTagName("head")[0].appendChild(i)}else{document.body.appendChild(i)}};d.katexURL={css:"//cdnjs.cloudflare.com/ajax/libs/KaTeX/0.7.1/katex.min",js:"//cdnjs.cloudflare.com/ajax/libs/KaTeX/0.7.1/katex.min"};d.kaTeXLoaded=false;d.loadKaTeX=function(i){d.loadCSS(d.katexURL.css,function(){d.loadScript(d.katexURL.js,i||function(){})})};d.lockScreen=function(i){f("html,body").css("overflow",(i)?"hidden":"")};d.createDialog=function(j){var s={name:"",width:420,height:240,title:"",drag:true,closed:true,content:"",mask:true,maskStyle:{backgroundColor:"#fff",opacity:0.1},lockScreen:true,footer:true,buttons:false};j=f.extend(true,s,j);var o=this;var k=this.editor;var i=d.classPrefix;var y=(new Date()).getTime();var m=((j.name==="")?i+"dialog-"+y:j.name);var w=d.mouseOrTouch;var t='<div class="'+i+"dialog "+m+'">';if(j.title!==""){t+='<div class="'+i+'dialog-header"'+((j.drag)?' style="cursor: move;"':"")+">";t+='<strong class="'+i+'dialog-title">'+j.title+"</strong>";t+="</div>"}if(j.closed){t+='<a href="javascript:;" class="fa fa-close '+i+'dialog-close"></a>'}t+='<div class="'+i+'dialog-container">'+j.content;if(j.footer||typeof j.footer==="string"){t+='<div class="'+i+'dialog-footer">'+((typeof j.footer==="boolean")?"":j.footer)+"</div>"}t+="</div>";t+='<div class="'+i+"dialog-mask "+i+'dialog-mask-bg"></div>';t+='<div class="'+i+"dialog-mask "+i+'dialog-mask-con"></div>';t+="</div>";k.append(t);var B=k.find("."+m);B.lockScreen=function(D){if(j.lockScreen){f("html,body").css("overflow",(D)?"hidden":"");o.resize()}return B};B.showMask=function(){if(j.mask){k.find("."+i+"mask").css(j.maskStyle).css("z-index",d.dialogZindex-1).show()}return B};B.hideMask=function(){if(j.mask){k.find("."+i+"mask").hide()}return B};B.loading=function(D){var E=B.find("."+i+"dialog-mask");E[(D)?"show":"hide"]();return B};B.lockScreen(true).showMask();B.show().css({zIndex:d.dialogZindex,border:(d.isIE8)?"1px solid #ddd":"",width:(typeof j.width==="number")?j.width+"px":j.width,height:(typeof j.height==="number")?j.height+"px":j.height});var A=function(){B.css({top:(f(window).height()-B.height())/2+"px",left:(f(window).width()-B.width())/2+"px"})};A();f(window).resize(A);B.children("."+i+"dialog-close").bind(w("click","touchend"),function(){B.hide().lockScreen(false).hideMask()});if(typeof j.buttons==="object"){var x=B.footer=B.find("."+i+"dialog-footer");for(var C in j.buttons){var q=j.buttons[C];var n=i+C+"-btn";x.append('<button class="'+i+"btn "+n+'">'+q[0]+"</button>");q[1]=f.proxy(q[1],B);x.children("."+n).bind(w("click","touchend"),q[1])}}if(j.title!==""&&j.drag){var r,p;var u=B.children("."+i+"dialog-header");if(!j.mask){u.bind(w("click","touchend"),function(){d.dialogZindex+=2;B.css("z-index",d.dialogZindex)})}u.mousedown(function(D){D=D||window.event;r=D.clientX-parseInt(B[0].style.left);p=D.clientY-parseInt(B[0].style.top);document.onmousemove=v});var l=function(D){D.removeClass(i+"user-unselect").off("selectstart")};var z=function(D){D.addClass(i+"user-unselect").on("selectstart",function(E){return false})};var v=function(H){H=H||window.event;var G,F,E=parseInt(B[0].style.left),D=parseInt(B[0].style.top);if(E>=0){if(E+B.width()<=f(window).width()){G=H.clientX-r}else{G=f(window).width()-B.width();document.onmousemove=null}}else{G=0;document.onmousemove=null}if(D>=0){F=H.clientY-p}else{F=0;document.onmousemove=null}document.onselectstart=function(){return false};z(f("body"));z(B);B[0].style.left=G+"px";B[0].style.top=F+"px"};document.onmouseup=function(){l(f("body"));l(B);document.onselectstart=null;document.onmousemove=null};u.touchDraggable=function(){var E=null;var F=function(G){var I=G.originalEvent;var H=f(this).parent().position();E={x:I.changedTouches[0].pageX-H.left,y:I.changedTouches[0].pageY-H.top}};var D=function(G){G.preventDefault();var H=G.originalEvent;f(this).parent().css({top:H.changedTouches[0].pageY-E.y,left:H.changedTouches[0].pageX-E.x})};this.bind("touchstart",F).bind("touchmove",D)};u.touchDraggable()}d.dialogZindex+=2;return B};d.mouseOrTouch=function(n,o){n=n||"click";o=o||"touchend";var m=n;var i=navigator.userAgent;var l=new Array("Android","iPhone","SymbianOS","Windows Phone","iPad","iPod");var j=false;for(var k=0;k<l.length;k++){if(i.indexOf(l[k])>0){j=true;break}}if(j){m=o}return m};d.dateFormat=function(v){v=v||"";var o=function(A){return(A<10)?"0"+A:A};var w=new Date();var p=w.getFullYear();var j=p.toString().slice(2,4);var x=o(w.getMonth()+1);var u=o(w.getDate());var q=w.getDay();var m=o(w.getHours());var t=o(w.getMinutes());var y=o(w.getSeconds());var s=o(w.getMilliseconds());var r="";var z=j+"-"+x+"-"+u;var i=p+"-"+x+"-"+u;var k=m+":"+t+":"+y;switch(v){case"UNIX Time":r=w.getTime();break;case"UTC":r=w.toUTCString();break;case"yy":r=j;break;case"year":case"yyyy":r=p;break;case"month":case"mm":r=x;break;case"cn-week-day":case"cn-wd":var l=["日","一","二","三","四","五","六"];r="星期"+l[q];break;case"week-day":case"wd":var n=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];r=n[q];break;case"day":case"dd":r=u;break;case"hour":case"hh":r=m;break;case"min":case"ii":r=t;break;case"second":case"ss":r=y;break;case"ms":r=s;break;case"yy-mm-dd":r=z;break;case"yyyy-mm-dd":r=i;break;case"yyyy-mm-dd h:i:s ms":case"full + ms":r=i+" "+k+" "+s;break;case"full":case"yyyy-mm-dd h:i:s":default:r=i+" "+k;break}return r};return d}));